{% extends "base.html" %}
{% block content %}
<div style="text-align: center; margin-top: 20px;">
  <img src="{{ url_for('static', filename='img/kitakongsi.png') }}" alt="logo1" />
</div>

<h2>Make a Donation</h2>
<form method="post" class="mt-4">
    <div class="mb-3">
        <label>Donation Type</label>
        <select name="donation_type" class="form-select" id="donationType">
            <option value="money">Select Type</option>
            <option value="money">Money</option>
            <option value="food">Food</option>
        </select>
    </div>

    <div id="moneyFields" class="mb-3">
        <label>Amount</label>
        <input type="number" name="amount" step="0.01" class="form-control" id="amount">
        
    </div>

    <div id="foodFields" class="mb-3 d-none">
        <label>Food Type</label>
        <!-- <input type="text" name="food_type" class="form-control"> -->
         <select name="food_type" class="form-select" id="food_type">
            <option value="">Select State</option>
            <option value="rice">Rice</option>
            <option value="oil">Vegetable Oil</option>
            <option value="beans">Lentils or beans</option>
            <option value="salt">Salt </option>
        </select>
        <label class="mt-2">Quantity</label>
        <input type="number" name="quantity" class="form-control" id="quantity">
    </div>



    <button class="btn btn-success mt-3" type="submit">Donate</button>
</form>

<!-- Your existing donation form here -->

<h2>Donation and Request History</h2>
<table cellpadding="5" cellspacing="0" style="width:100%; max-width:700px; margin:auto;">
    <thead>
        <tr style="background-color:#4CAF50; color:white;">
            <th>No.</th>
            <th>Type</th>
            <th>Details</th>
            <th>Timestamp</th>
        </tr>
    </thead>
    <tbody>
        {% for tx in transactions %}
        <tr style="background-color: white">
            <td>{{ loop.index }}</td>
            <td>{{ tx.type.replace('_', ' ').title() }}</td>
            <td>
                {% if tx.type == 'money_donation' or tx.type == 'money_request' %}
                    Amount: RM {{ "%.2f"|format(tx.amount) }}
                {% elif tx.type == 'food_donation' or tx.type == 'food_request' %}
                    Food: {{ tx.food_type }}, Quantity: {{ tx.quantity }}
                {% else %}
                    -
                {% endif %}
            </td>
            <td>{{ tx.timestamp }}</td>
        </tr>
        {% else %}
        <tr>
            <td colspan="4" style="text-align:center;">No transactions found.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>


<h4 class="mt-5">Current Balances</h4>
<p>Money: RM{{ money_balance }}</p>
<p>Food: {{ food_balance }}</p>

<script>
document.getElementById("donationType").addEventListener("change", function(){
    document.getElementById("moneyFields").classList.toggle("d-none", this.value !== "money");
    document.getElementById("foodFields").classList.toggle("d-none", this.value !== "food");
});
</script>
{% endblock %}
